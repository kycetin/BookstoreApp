
{% extends "base_generic.html" %}

{% block content %}

<!-- <div class="row row-cols-1 row-cols-md-4 g-4"> -->
<!--   {% for list in ls %} -->
<!--   <div class="col"> -->
<!--     <div class="card h-90"> -->
<!--       <img -->
<!--         src={{list.image}} -->
<!--         class="card-img-top" -->
<!--         alt="..." -->
<!--       /> -->
<!--       <div class="card-body"> -->
<!--         <h5 class="card-title">{{list.title}}</h5> -->
<!--         <\!-- <p class="card-text"> -\-> -->
<!--         <\!--   {{list.authors}} -\-> -->
<!--         <\!-- </p> -\-> -->
<!--     <button type="button" class="btn btn-secondary">Read More</button> -->
<!--     <button id="{{list.isbn13}}" type="button" class="btn btn-dark" onclick="addToBookmark()">Add to Bookmark</button> -->
<!--       </div> -->
<!--     </div> -->
<!--   </div> -->
<!--   {% endfor %} -->
<!-- </div> -->
<div class="row row-cols-1 row-cols-md-4 g-4 ">
  {% for list in ls %}
  <div class="col">
  <div class="card"><img src={{list.image}}>
    <div class="info">
      <h4>{{list.title}}</h4>
      <p>{{list.subtitle}}</p>
      <p>{{list.price}}</p>
      <button id="readMore{{list.isbn13}}" type="button" class="btn btn-dark" value="{{list.isbn13}}" onclick="readMore()">Read More</button>
      <button id="bookmarked{{list.isbn13}}" type="button" class="btn btn-dark" value="{{list.isbn13}}" onclick="addToBookmark()">Add to Bookmark</button>
    </div>
  </div>
  </div>
  {% endfor %}
</div>
<nav >
  <ul class="pagination justify-content-center">
        {% if  current_page > 1 %}
            <li class="page-item" >
              <a class="page-link" href="/search/{{keyword}}/1" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
                <span class="sr-only">First</span>
              </a>
            </li>
            <li class="page-item">
              <a class="page-link" href="/search/{{keyword}}/{{current_page|add:'-1'}}" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
                <span class="sr-only">Previous</span>
              </a>
            </li>
        {% endif %}
        {% for i in range %}
            {% if  i|add:'-5' < current_page and i|add:'5' > current_page  %}
                {% if i == current_page %}
                    <li class="page-item active" aria-current="page">
                    <a class="page-link" href="/search/{{keyword}}/{{i}}">{{i}}</a></li>
                {% else %}
                    <li class="page-item"><a class="page-link" href="/search/{{keyword}}/{{i}}">{{i}}</a></li>
                {% endif %}
            {% endif %}
        {% endfor %}
        {% if current_page < pg %}
            <li class="page-item">
        {% if current_page == 0 %}
              <a class="page-link" href="/search/{{keyword}}/{{current_page|add:'2'}}" aria-label="Next">
                {% else %}
              <a class="page-link" href="/search/{{keyword}}/{{current_page|add:'1'}}" aria-label="Next">
        {% endif %}
                <span aria-hidden="true">&raquo;</span>
                <span class="sr-only">Next</span>
              </a>
            </li>
            <li class="page-item">
              <a class="page-link" href="/search/{{keyword}}/{{pg}}" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
                <span class="sr-only">Last</span>
              </a>
            </li>
        {% endif %}
  </ul>
</nav>

<script>
function setback(button_id) {
  $("#bookmarked"+button_id).text("Add to Bookmark");
          $("#bookmarked"+button_id).css("background","#212529");
}
 function search_value(){

     let search_input = document.getElementById('search_input').value;
    console.log(search_input);
    let cookie = document.cookie
let csrfToken = cookie.substring(cookie.indexOf('=') + 1)

  $.ajax({
  url: '/store_search/',
  method : 'POST',
         headers: {
           'X-CSRFToken': csrfToken
         },
  data: {"search_input": search_input},
  beforeSend: function() {
   // things to do before submit
  },
  success: function(data) {


   }
   });
    

             // $.ajax({
             // url: '/booklist_search/',
             // method : 'POST',
             // data: {search: $('#search_input').val()},
             // beforeSend: function() {
             //  // things to do before submit
             // },
             // success: function(response) {

             //  alert(response)
             //  }
             //  });
}
function addToBookmark() {
    // console.log($(this).attr("id"));

    let buttonId = event.srcElement.value;
    console.log(buttonId);
    let cookie = document.cookie
let csrfToken = cookie.substring(cookie.indexOf('=') + 1)

  $.ajax({
  url: '/bookmarks/add_bookmark/',
  method : 'POST',
         headers: {
           'X-CSRFToken': csrfToken
         },
  data: {"button_id": buttonId},
  beforeSend: function() {
   // things to do before submit
  },
  success: function(data) {
      console.log(data);
      button_id = data.data
      if (data.response == "added")
      {
          $("#bookmarked"+button_id).text("Added Successfuly");
          $("#bookmarked"+button_id).css("background","green");
          setTimeout("setback(button_id)", 1000);
      }
      else
      {

          $("#bookmarked"+button_id).text("Already Exist");
          $("#bookmarked"+button_id).css("background","red");
          setTimeout("setback(button_id)", 1000);
      }


   }
   });
    
}

 function readMore(){

     let search_input = document.getElementById('search_input').value;
    console.log(search_input);
    let cookie = document.cookie
let csrfToken = cookie.substring(cookie.indexOf('=') + 1)

  $.ajax({
  url: '/read_more/',
  method : 'POST',
         headers: {
           'X-CSRFToken': csrfToken
         },
  data: {"search_input": search_input},
  beforeSend: function() {
   // things to do before submit
  },
  success: function(data) {
      console.log(data);


   }
   });
</script>

{% endblock %}

